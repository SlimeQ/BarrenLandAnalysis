# BarrenLandAnalysis

## Dependencies
A working Java installation is required.

## Structure
This project contains 3 subprojects:
- shared
  - Contains a `BarrenLandAnalyzer` class that can be used to process input.
- cli
  - Reads from STDIN, writes to STDOUT.
- server
  - Provides a web interface for using the Barren Land Analyzer.

## Building
This project uses the gradle wrapper. To build, enter `$ ./gradlew build`

## Testing
Tests will be run automatically on build, but to force tests to run you can enter `$ ./gradlew test`

## Command Line Interface Usage
The cli package reads from STDIN and writes to STDOUT. The program will immediately wait for a newline terminated input string and then output a string according to the project specifications. Optionally, you can generate an image file to visualize the resulting land grid by using the `-visualize <filename>` switch.

```
$ java -jar cli/build/libs/BarrenLandAnalysis-cli.jar -visualize sample_visualization.bmp
{"48 192 351 207", "48 392 351 407", "120 52 135 547", "260 52 275 547"}
22816 192608
```

![Visualization](https://github.com/SlimeQ/BarrenLandAnalysis/blob/master/sample_visualization.bmp)

## Server Usage
The server package exposes BarrenLandAnalyzer functionality via a web page. To start the server, build the project and run the following command:
```$ java -jar server/build/libs/BarrenLandAnalysis-server.jar```

The server listens on port 8080 by default. This is a Spring-Boot server with two endpoints:

- `/` Serves a homepage with an AJAX form to interact with the server.
- `/analyze`
  - Accepts a POST request containing only a raw BarrenLandAnalysis input string.
    ```
    {“48 192 351 207”, “48 392 351 407”, “120 52 135 547”, “260 52 275 547”}
    ```
  - Returns a JSON object containing both the computed output string and the visualization image as a Base64 string.
    ```
    {
      "output":"22816 192608",
      "visualization":"data:image/png;base64, Qk22/AoAAAAAADYAAAAoAAAAkAEAAFgCAAABA..."
    }
    ```
    
 The server will also expose test reports generated by Junit. These will be located at `/reports/shared/index.html` and `/reports/server/index.html` and are linked to at the bottom of the homepage. For this function to work properly, the jar **must** be run from the project root since these files are located on the file system.
